<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>表达式求值</title>
    <url>/2019/12/20/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B1%82%E5%80%BC/</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>表达式求值是栈这种数据结构的一个很经典的应用，恰逢是数据结构期末实践题目，经过一定的努力终于也是实现了这个算法，所以分享下我的思路和经验，希望正准备尝试解决这个问题的同学可以少走些弯路，有所借鉴和收获。</p>
<p><strong>个人水平有限，文笔拙劣，有所意见和建议欢迎指出</strong></p>
<a id="more"></a>

<p>我们日常使用的四则运算式如 1+1 被称为中缀表达式，即所有的运算符号都在运算数的中间出现，我们在初学编程时都练习过简单的二元运算，但当求值问题扩大到一个完整的四则运算式的时候，就需要考虑<strong>运算符优先级、括号</strong>等多个问题，解决了这些问题也就实现了表达式求值。</p>
<p>表达式求值问题常用的也是最广泛的解决方法是逆波兰式转换法，主要步骤可简单分为两步，用户输入的中缀表达式转化为后缀表达式（逆波兰式），再对逆波兰式进行运算。但在编程过程中我发现简单的分为两步是行不通的，因为涉及到多位数和浮点数，由于输入时统一存储为字符串，在进行中缀到后缀的转换后无法得到正确的后缀式字符串，由于c语言中char型数据实际上也是int型数据，这就进一步增加了正确转换的难度，从而也就无法在逆波兰式的计算中得出正确的结果，所以在编程实现时将这两步合为一个函数实现，<strong>即以字符串形式存储键盘输入的表达式后，对该字符串逐位处理，通过ASCII码值的判断分为数字或小数点、运算符两种情况，然后按照判断结果执行相应的语句。</strong></p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>创建<strong>一char型数组</strong>用于存储输入的中缀表达式，在中缀表达式向后缀表达式的转化以及后缀表达式的计算中（<strong>详情见各种数据结构教材或书籍，或相关博客，实现此算法必须要实现了解这些过程</strong>）我们知道，因为涉及到运算符优先级的判断和后缀表达式的计算的部分我们需要借助栈来实现，所以需要创建<strong>一double型栈和一char型栈</strong>，分别用于存储操作数和运算符，栈的存储可随意选用线性结构或链式结构，需要实现以下操作函数：</p>
<ul>
<li>初始化</li>
<li>出栈</li>
<li>入栈</li>
<li>取栈顶</li>
<li>判空</li>
</ul>
<p>接下来对如何处理输入的表达式做详细介绍</p>
<h3 id="1-数字或小数点（非运算符）"><a href="#1-数字或小数点（非运算符）" class="headerlink" title="1.数字或小数点（非运算符）"></a>1.数字或小数点（非运算符）</h3><p><img src="/images/ascii.png" alt="ascii">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>上图为ASCII码对照表</p>
<p>通过ASCII码我们可以得出输入的是数字（0-9）的条件，但因为存在多位数的情况，所以当前数字可能是输入的操作数的十位或百位等，所以不能简单的压入数字栈就完事，我的解决方法是每当遇到数字位都进行一次判断，检查表达式字符串中它的前一位是否为数字，若是，则说明这是个多位数，则将前一位（已入栈）出栈与10的n次幂做乘积后与当前位求和再入栈；对于例如12.34这类浮点数，则在判断当前位不是运算符后首先检查是否为小数点，若是则说明直到下一个运算符都是该浮点数的小数位，则与求多位整数（例12.34的整数位）值类似，与10的负n次幂做乘积累加求和知道遇到下一个运算符时入栈。</p>
<p><img src="/images/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B1%82%E5%80%BC%E5%AD%90%E5%9B%BE2.png" alt="表达式求值子图2">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>上图是我做的流程图（第一次做，略丑，希望能帮助理解即可）</p>
<h3 id="2-运算符"><a href="#2-运算符" class="headerlink" title="2.运算符"></a>2.运算符</h3><p>运算符的处理相对于操作数就简单许多了，唯一的小问题就是运算符优先级的判断，我第一次写的时候写了层层嵌套的if和switch语句，做了简化修改后可以这样写：</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Precede</span><span class="params">(<span class="keyword">char</span> c1,<span class="keyword">char</span> c2)</span></span>&#123;</span><br><span class="line">	<span class="comment">//判定运算符的栈顶运算符与读入的运算符之间优先关系</span></span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">switch</span>(c1)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">	    	<span class="keyword">switch</span>(c2)&#123;</span><br><span class="line">		        <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">	            <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">		        <span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">	            <span class="keyword">case</span> <span class="string">'#'</span>:</span><br><span class="line">			    	c=<span class="string">'&gt;'</span>;</span><br><span class="line">	               	<span class="keyword">break</span>;</span><br><span class="line">		        <span class="keyword">default</span>:</span><br><span class="line">			    	c=<span class="string">'&lt;'</span>;</span><br><span class="line">	    	&#125;</span><br><span class="line">        	<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">            <span class="keyword">if</span>(c2==<span class="string">'('</span>)&#123;</span><br><span class="line">				c=<span class="string">'&lt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				c=<span class="string">'&gt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'('</span>:</span><br><span class="line">		    <span class="keyword">if</span>(c2==<span class="string">')'</span>)&#123;</span><br><span class="line">				c=<span class="string">'='</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    <span class="keyword">else</span>&#123;</span><br><span class="line">				c=<span class="string">'&lt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">	    	c=<span class="string">'&gt;'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'#'</span>:</span><br><span class="line">		    <span class="keyword">if</span>(c2==<span class="string">'#'</span>)&#123;</span><br><span class="line">				c=<span class="string">'='</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    <span class="keyword">else</span>&#123;</span><br><span class="line">				c=<span class="string">'&lt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>解决了优先级的判断问题后，根据中缀转后缀的步骤，优先级高于栈顶入栈，低的出栈运算直到栈顶元素优先级低于当前位，思路如下：<img src="/images/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B1%82%E5%80%BC%E5%AD%90%E5%9B%BE3.png" alt="表达式求值子图3">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p>如上所述，对表达式字符串处理完毕后，此时运算结果其实就是操作数栈的栈顶元素，且操作数栈仅剩该数字，输出即可。</p>
<p>下面是完整代码和流程图，如果文字描述不足以让你彻底明白这个问题的解决方法，希望能静下心多看看代码，愿你能保持学习的热情</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//zhao6582@qq.com 12/18</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="comment">//double栈，用于存放运算数 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="keyword">double</span> data[MAXSIZE];</span><br><span class="line">	<span class="keyword">int</span> top;</span><br><span class="line">&#125;Stack_n;</span><br><span class="line"><span class="comment">//char栈，用于存放运算符</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">	<span class="keyword">char</span> data[MAXSIZE];</span><br><span class="line">	<span class="keyword">int</span> top;</span><br><span class="line">&#125;Stack_c;</span><br><span class="line"><span class="comment">//栈的初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_n</span><span class="params">(Stack_n s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_c</span><span class="params">(Stack_c s)</span></span>;</span><br><span class="line"><span class="comment">////栈的判空函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsEmpty_n</span><span class="params">(Stack_n s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsEmpty_c</span><span class="params">(Stack_c s)</span></span>;</span><br><span class="line"><span class="comment">//入栈函数 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push_n</span><span class="params">(Stack_n *s,<span class="keyword">double</span> e)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push_c</span><span class="params">(Stack_c *s,<span class="keyword">char</span> e)</span></span>;</span><br><span class="line"><span class="comment">//出栈函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pop_n</span><span class="params">(Stack_n *s,<span class="keyword">double</span> *e)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pop_c</span><span class="params">(Stack_c *s,<span class="keyword">char</span> *e)</span></span>;</span><br><span class="line"><span class="comment">//取栈顶函数</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">GetTop_n</span><span class="params">(Stack_n s)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">GetTop_c</span><span class="params">(Stack_c s)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Precede</span><span class="params">(<span class="keyword">char</span> c1,<span class="keyword">char</span> c2)</span></span>;<span class="comment">//判断优先级 </span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Operate</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">char</span> theta,<span class="keyword">double</span> b)</span></span>;<span class="comment">//二元运算 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">In</span><span class="params">(<span class="keyword">char</span> c,<span class="keyword">char</span> *OP)</span></span>;<span class="comment">//是否为 + - * / ( ) </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span> *s)</span></span>;<span class="comment">//用于检查输入的多项式格式是否正确</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Poland</span><span class="params">(<span class="keyword">char</span> * s)</span></span>;<span class="comment">//主要功能实现函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> OP[<span class="number">7</span>]=&#123;<span class="string">'+'</span>,<span class="string">'-'</span>,<span class="string">'*'</span>,<span class="string">'/'</span>,<span class="string">'('</span>,<span class="string">')'</span>,<span class="string">'#'</span>&#125;; <span class="comment">//运算符数组(因多个函数使用故声明为公有的)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> s[<span class="number">100</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"请输入表达式：\n"</span>);</span><br><span class="line">	gets(s);</span><br><span class="line">	<span class="keyword">double</span> r = Poland(s);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%1.2lf\n"</span>,r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_n</span><span class="params">(Stack_n *s)</span></span>&#123;</span><br><span class="line">	s-&gt;top = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_c</span><span class="params">(Stack_c *s)</span></span>&#123;</span><br><span class="line">	s-&gt;top = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//栈的判空函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsEmpty_n</span><span class="params">(Stack_n s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(s.top == <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IsEmpty_c</span><span class="params">(Stack_c s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(s.top == <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//入栈函数 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push_n</span><span class="params">(Stack_n *s,<span class="keyword">double</span> e)</span></span>&#123;</span><br><span class="line">	s-&gt;top++;</span><br><span class="line">	s-&gt;data[s-&gt;top] = e;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Push_c</span><span class="params">(Stack_c *s,<span class="keyword">char</span> e)</span></span>&#123;</span><br><span class="line">	s-&gt;top++;</span><br><span class="line">	s-&gt;data[s-&gt;top] = e;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//出栈函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pop_n</span><span class="params">(Stack_n *s,<span class="keyword">double</span> *e)</span></span>&#123;</span><br><span class="line">	*e = s-&gt;data[s-&gt;top];</span><br><span class="line">	s-&gt;top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Pop_c</span><span class="params">(Stack_c *s,<span class="keyword">char</span> *e)</span></span>&#123;</span><br><span class="line">	*e = s-&gt;data[s-&gt;top];</span><br><span class="line">	s-&gt;top--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//取栈顶函数</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">GetTop_n</span><span class="params">(Stack_n s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> s.data[s.top];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">GetTop_c</span><span class="params">(Stack_c s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> s.data[s.top];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">Precede</span><span class="params">(<span class="keyword">char</span> c1,<span class="keyword">char</span> c2)</span></span>&#123;</span><br><span class="line">	<span class="comment">//判定运算符的栈顶运算符与读入的运算符之间优先关系</span></span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">switch</span>(c1)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">	    	<span class="keyword">switch</span>(c2)&#123;</span><br><span class="line">		        <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">	            <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">		        <span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">	            <span class="keyword">case</span> <span class="string">'#'</span>:</span><br><span class="line">			    	c=<span class="string">'&gt;'</span>;</span><br><span class="line">	               	<span class="keyword">break</span>;</span><br><span class="line">		        <span class="keyword">default</span>:</span><br><span class="line">			    	c=<span class="string">'&lt;'</span>;</span><br><span class="line">	    	&#125;</span><br><span class="line">        	<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">            <span class="keyword">if</span>(c2==<span class="string">'('</span>)&#123;</span><br><span class="line">				c=<span class="string">'&lt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				c=<span class="string">'&gt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'('</span>:</span><br><span class="line">		    <span class="keyword">if</span>(c2==<span class="string">')'</span>)&#123;</span><br><span class="line">				c=<span class="string">'='</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    <span class="keyword">else</span>&#123;</span><br><span class="line">				c=<span class="string">'&lt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">')'</span>:</span><br><span class="line">	    	c=<span class="string">'&gt;'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'#'</span>:</span><br><span class="line">		    <span class="keyword">if</span>(c2==<span class="string">'#'</span>)&#123;</span><br><span class="line">				c=<span class="string">'='</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		    <span class="keyword">else</span>&#123;</span><br><span class="line">				c=<span class="string">'&lt;'</span>;</span><br><span class="line">			&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Operate</span><span class="params">(<span class="keyword">double</span> a,<span class="keyword">char</span> theta,<span class="keyword">double</span> b)</span></span>&#123;</span><br><span class="line">	<span class="comment">//进行二元运算 a theta b</span></span><br><span class="line">	<span class="keyword">double</span> sum;</span><br><span class="line">    <span class="keyword">switch</span>(theta)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">	   sum=a+b;</span><br><span class="line">	   <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">	   sum=a-b;</span><br><span class="line">	   <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">           sum=a*b;</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">       <span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">           sum=a/b;</span><br><span class="line">	   <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">In</span><span class="params">(<span class="keyword">char</span> c,<span class="keyword">char</span> *OP)</span></span>&#123;</span><br><span class="line">    <span class="comment">//判断是不是运算符</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">7</span>;i++)</span><br><span class="line">       <span class="keyword">if</span>(c==OP[i])   <span class="comment">//是运算符</span></span><br><span class="line">          <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断思路：当前字符是运算符且前一位或后一位也是运算符且这3位都不为‘（’和‘）’时说明连续输入了两个运算符</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">check</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> *t = s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="built_in">strlen</span>(s);i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i &gt; <span class="number">0</span> &amp;&amp; i &lt; <span class="built_in">strlen</span>(s) - <span class="number">1</span> &amp;&amp; In(s[i],OP) &amp;&amp; (In(s[i - <span class="number">1</span>],OP) || In(s[i + <span class="number">1</span>],OP))</span><br><span class="line">			&amp;&amp;(s[i] != <span class="string">'('</span> &amp;&amp; s[i] != <span class="string">')'</span>) &amp;&amp; (s[i - <span class="number">1</span>] != <span class="string">'('</span> &amp;&amp; s[i - <span class="number">1</span>] != <span class="string">')'</span>)</span><br><span class="line">			&amp;&amp;(s[i + <span class="number">1</span>] != <span class="string">'('</span> &amp;&amp; s[i + <span class="number">1</span>] != <span class="string">')'</span>))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"输入格式有误！！请检查是否存在连续输入了运算符等错误！！\n"</span>);</span><br><span class="line">			getchar();</span><br><span class="line">			<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Poland</span><span class="params">(<span class="keyword">char</span> * s)</span></span>&#123;</span><br><span class="line">	<span class="comment">//对多项式格式进行检查</span></span><br><span class="line">	check(s);</span><br><span class="line">    <span class="comment">//进行多项式的求值以及后缀表达式的输出</span></span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,len,flag=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> a,b,sum;</span><br><span class="line">    <span class="keyword">char</span> c1=s[<span class="number">0</span>],e;</span><br><span class="line">    </span><br><span class="line">    Stack_c OPTR; 	<span class="comment">//运算符栈</span></span><br><span class="line">    Stack_n OPND; 	<span class="comment">//运算数栈</span></span><br><span class="line">    Init_c(&amp;OPTR);  <span class="comment">//初始化栈</span></span><br><span class="line">    Init_n(&amp;OPND);</span><br><span class="line">    </span><br><span class="line">    len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    s[len]=<span class="string">'#'</span>;</span><br><span class="line">    s[len+<span class="number">1</span>]=<span class="string">'\0'</span>;</span><br><span class="line">    Push_c(&amp;OPTR,<span class="string">'#'</span>);<span class="comment">//补‘#’作为结束标志</span></span><br><span class="line">    <span class="keyword">while</span>(s[i]!=<span class="string">'#'</span>||GetTop_c(OPTR)!=<span class="string">'#'</span>)&#123; <span class="comment">//遍历每一个字符 为‘#’结束循环</span></span><br><span class="line">		<span class="keyword">if</span>(s[i] == <span class="string">' '</span>)&#123;</span><br><span class="line">			i++;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="keyword">if</span>(!In(s[i],OP))&#123; <span class="comment">//如果不是运算符</span></span><br><span class="line">	        <span class="keyword">if</span>(c1==<span class="string">'.'</span>)&#123;<span class="comment">//如果上一个字符是小数点</span></span><br><span class="line">		        flag++;</span><br><span class="line">		    &#125;</span><br><span class="line">		    <span class="keyword">if</span>(flag)&#123;</span><br><span class="line">		    	<span class="keyword">double</span> t;</span><br><span class="line">		    	Pop_n(&amp;OPND,&amp;t);</span><br><span class="line">				Push_n(&amp;OPND,t + (<span class="keyword">double</span>)(s[i] - <span class="string">'0'</span>) / <span class="built_in">pow</span>(<span class="number">10</span>,flag));<span class="comment">//对小数点后的部分 按位数运算并入栈 </span></span><br><span class="line">				flag++;</span><br><span class="line">			&#125;</span><br><span class="line">	        <span class="keyword">if</span>(s[i]!=<span class="string">'.'</span>&amp;&amp;!flag)&#123;</span><br><span class="line">	            <span class="keyword">if</span>(!In(c1,OP)&amp;&amp;!IsEmpty_n(OPND))&#123;<span class="comment">//如果上一个字符是数字（说明是多位数） 根据位数运算后入栈</span></span><br><span class="line">	            	<span class="keyword">double</span> t;</span><br><span class="line">	            	Pop_n(&amp;OPND,&amp;t);</span><br><span class="line">	                Push_n(&amp;OPND,t * <span class="number">10</span> + s[i] - <span class="string">'0'</span>);</span><br><span class="line">	            &#125;</span><br><span class="line">	            <span class="keyword">else</span><span class="comment">//否则压入运算数栈</span></span><br><span class="line">	            	Push_n(&amp;OPND,(<span class="keyword">double</span>)(s[i]-<span class="string">'0'</span>));</span><br><span class="line">		    &#125;</span><br><span class="line">	    	c1=s[i++]; <span class="comment">//读取下一个字符</span></span><br><span class="line">	    &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;<span class="comment">//如果是运算符</span></span><br><span class="line">            flag=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">switch</span>(Precede(GetTop_c(OPTR),s[i]))&#123;</span><br><span class="line">                 <span class="keyword">case</span> <span class="string">'&gt;'</span>:  <span class="comment">//当前运算符优先级低</span></span><br><span class="line">		             Pop_c(&amp;OPTR,&amp;e); <span class="comment">//运算符出栈,和操作数的头两个数运算 </span></span><br><span class="line">		             Pop_n(&amp;OPND,&amp;b);</span><br><span class="line">                     Pop_n(&amp;OPND,&amp;a);</span><br><span class="line">		             Push_n(&amp;OPND,Operate(a,e,b)); <span class="comment">//计算结果入栈</span></span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                 <span class="keyword">case</span> <span class="string">'='</span>: <span class="comment">//优先级相等</span></span><br><span class="line">		             Pop_c(&amp;OPTR,&amp;e); <span class="comment">//弹出运算符栈顶元素</span></span><br><span class="line">		             c1 = s[i++];</span><br><span class="line">                     <span class="keyword">break</span>;</span><br><span class="line">                 <span class="keyword">case</span> <span class="string">'&lt;'</span>:</span><br><span class="line">		          	Push_c(&amp;OPTR,s[i]); <span class="comment">//当前运算符优先级高 入栈</span></span><br><span class="line">		            c1 = s[i++];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">	    	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sum=GetTop_n(OPND);</span><br><span class="line">    <span class="keyword">return</span> sum; <span class="comment">//返回运算数栈顶元素，即运算结果 </span></span><br><span class="line">&#125;<span class="comment">//@@ end @@</span></span><br></pre></td></tr></table></figure>

<p><img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><img src="/images/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B1%82%E5%80%BC.png" alt="表达式求值">)<img src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="点击并拖拽以移动"></p>
<p><strong><em>代码也是看了很多博客帖子后总结出来的，建议好好利用搜索引擎。\</em></strong></p>
<p><strong><em>栈的实现、逆波兰转换和计算等基本概念很多书都有，我看的是学校教材，清华大学出版社出版、***</em></strong>严蔚敏老师的*<strong><em>**《数据结构（C语言版）》和程杰老师的《大话数据结构》。\</em></strong></p>
]]></content>
      <tags>
        <tag>数据结构 - 栈</tag>
      </tags>
  </entry>
  <entry>
    <title>栈和队列的转换</title>
    <url>/2019/12/17/%E6%A0%88%E5%92%8C%E9%98%9F%E5%88%97%E7%9A%84%E8%BD%AC%E6%8D%A2/</url>
    <content><![CDATA[<h1 id="用栈实现队列-amp-用队列实现栈问题"><a href="#用栈实现队列-amp-用队列实现栈问题" class="headerlink" title="用栈实现队列&amp;用队列实现栈问题"></a>用栈实现队列&amp;用队列实现栈问题</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>栈和队列是两种常见的数据结构，简单概括就是栈是“先入后出”的读写规则，队列则遵循“先入先出”的顺序，在理解这些的基础上对于如何使用A实现B的问题就很容易实现了。</p>
<a id="more"></a>

<h2 id="一-栈实现队列"><a href="#一-栈实现队列" class="headerlink" title="一.栈实现队列"></a>一.栈实现队列</h2><h3 id="1-思路分析"><a href="#1-思路分析" class="headerlink" title="1.思路分析"></a>1.思路分析</h3><p>首先，队列的基本操作有入队操作<code>add</code>、出队操作<code>pool</code>和取队首操作<code>peek</code>，而按照队列的“先入先出”的规律，我们可以新建一个数据栈data和一个辅助栈help来实现这些操作，<code>add</code>时将数据压入data栈即可，例如依次<code>add</code>1、2、3、4、5，这时data栈存储情况如下图<img src="/images/stacktoqueue1.png" alt="stacktoqueue1"></p>
<p>假如此时执行<code>pool</code>操作，按栈的读取规则得到的是最后入栈、处于栈顶的5，显然是不正确的(应当是最先输入的1)，那么如何得到正确的读取序列呢？其实很简单，还记得刚刚提过的辅助栈吗，我们将data栈内的数据依次弹出直到data栈弹空<img src="/images/stacktoqueue2.png" alt="stacktoqueue2"></p>
<p>这时我们发现，只要对help栈执行出栈操作，即可按正确的顺序输出了。</p>
<h3 id="2-完整代码"><a href="#2-完整代码" class="headerlink" title="2.完整代码"></a>2.完整代码</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackToQueue</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Stack&lt;Integer&gt; data;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Stack&lt;Integer&gt; help;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StackToQueue</span><span class="params">()</span></span>&#123;</span><br><span class="line">        data = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        help = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> newNum)</span></span>&#123;</span><br><span class="line">        data.push(newNum);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">peek</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(help.empty())&#123;</span><br><span class="line">            <span class="keyword">while</span>(!data.empty())&#123;</span><br><span class="line">                <span class="keyword">int</span> t = data.pop();</span><br><span class="line">                help.push(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> help.peek();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">poll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(help.empty())&#123;</span><br><span class="line">            <span class="keyword">while</span>(!data.empty())&#123;</span><br><span class="line">                <span class="keyword">int</span> t = data.pop();</span><br><span class="line">                help.push(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> help.pop();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StackToQueue queue = <span class="keyword">new</span> StackToQueue();</span><br><span class="line">        queue.add(<span class="number">1</span>);</span><br><span class="line">        queue.add(<span class="number">2</span>);</span><br><span class="line">        queue.add(<span class="number">3</span>);</span><br><span class="line">        System.out.println(queue.poll());</span><br><span class="line">        queue.add(<span class="number">4</span>);</span><br><span class="line">        queue.add(<span class="number">5</span>);</span><br><span class="line">        System.out.println(queue.peek());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="二-队列实现栈"><a href="#二-队列实现栈" class="headerlink" title="二.队列实现栈"></a>二.队列实现栈</h2><h3 id="1-思路分析-1"><a href="#1-思路分析-1" class="headerlink" title="1.思路分析"></a>1.思路分析</h3><h3 id="2-完整代码-1"><a href="#2-完整代码-1" class="headerlink" title="2.完整代码"></a>2.完整代码</h3><h2 id="三-关联问题–栈的getMin-操作"><a href="#三-关联问题–栈的getMin-操作" class="headerlink" title="三.关联问题–栈的getMin()操作"></a>三.关联问题–栈的getMin()操作</h2><h3 id="1-思路分析-2"><a href="#1-思路分析-2" class="headerlink" title="1.思路分析"></a>1.思路分析</h3><h3 id="2-完整代码-2"><a href="#2-完整代码-2" class="headerlink" title="2.完整代码"></a>2.完整代码</h3>]]></content>
  </entry>
  <entry>
    <title>frist blog</title>
    <url>/2019/12/16/frist-blog/</url>
    <content><![CDATA[<h2 id="我的第一篇博客"><a href="#我的第一篇博客" class="headerlink" title="我的第一篇博客"></a>我的第一篇博客</h2><p>这里是我的技术博客，会记录一些学习过程中的体会和总结<br><a href="https://github.com/qingshui3000" target="_blank" rel="noopener">我的<code>github</code></a></p>
]]></content>
  </entry>
</search>
